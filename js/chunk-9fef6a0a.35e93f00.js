(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9fef6a0a"],{"16c2":function(t,e,s){},2409:function(t,e,s){},"3bc9":function(t,e,s){t.exports=s.p+"img/tweet-reply.2cbb392d.svg"},4565:function(t,e,s){},"4ba8":function(t,e,s){t.exports=s.p+"img/tweet-back.6008f2d3.svg"},"540b":function(t,e,s){"use strict";s("16c2")},"6f1a":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-twitter"},[e("NavBar"),e("section",{staticClass:"center-section"},[e("header",{staticClass:"header"},[e("img",{staticClass:"icon-back",attrs:{src:s("4ba8"),alt:""},on:{click:function(e){return t.$router.back()}}}),e("h4",{staticClass:"title"},[t._v("推文")])]),t.isLoading?e("Spinner"):e("div",{staticClass:"center-container scrollbar"},[e("TweetDetail",{attrs:{tweet:t.tweet,user:t.user}}),e("TweetReplies",{attrs:{initialreplies:t.replies,user:t.user}})],1)],1),e("TweetPopularUser")],1)},i=[],r=s("d000"),n=s("6e47"),c=function(){var t=this,e=t._self._c;return e("section",{staticClass:"tweet-popular-section"},[e("div",{staticClass:"tweet-popular-container"},[e("div",{staticClass:"tweet"},[e("div",{staticClass:"tweet-info"},[e("div",{staticClass:"tweet-user-container"},[e("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("router-link",{staticClass:"tweet-user",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[e("span",{staticClass:"tweet-user-name"},[t._v(t._s(t.user.name))]),e("span",{staticClass:"tweet-user-account"},[t._v("@"+t._s(t.user.account))])])],1),e("p",{staticClass:"tweet-content"},[t._v(" "+t._s(t.tweet.description)+" ")]),e("div",{staticClass:"tweet-time-container"},[e("div",{staticClass:"tweet-time"},[e("span",{staticClass:"tweet-time-create"},[t._v(t._s(t._f("date")(t.tweet.createdAt)))])])]),e("div",{staticClass:"tweet-data-container"},[e("div",{staticClass:"tweet-reply"},[e("strong",[t._v(t._s(t.tweet.repliedCounts))]),e("span",{staticClass:"tweet-icon-number"},[t._v("回覆")])]),e("div",{staticClass:"tweet-reply"},[e("strong",[t._v(t._s(t.tweet.likesCounts))]),e("span",{staticClass:"tweet-icon-number"},[t._v(" 喜歡次數")])])]),e("div",{staticClass:"tweet-icon-container"},[e("div",{staticClass:"tweet-reply"},[e("ModalTweetReply1",{staticClass:"tweet-icon-reply",attrs:{tweet:t.tweet,user:t.user}})],1),e("button",{staticClass:"tweet-like",attrs:{disabled:t.isProcessing}},[t.tweet.isBeingLiked?e("img",{staticClass:"tweet-icon-like",attrs:{src:s("cb58"),alt:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteLike(t.tweet.id)}}}):e("img",{staticClass:"tweet-icon-unlike",attrs:{src:s("a2b1"),alt:""},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addLike(t.tweet.id)}}})])])])])])])},o=[],l=(s("d9e2"),function(){var t=this,e=t._self._c;return e("section",{staticClass:"modal-tweet-section"},[e("button",{staticClass:"btn tweet-reply",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openModal.apply(null,arguments)}}},[e("img",{staticClass:"tweet-reply-icon",attrs:{src:s("3bc9"),alt:""}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.modalStatus,expression:"modalStatus"}],staticClass:"modal-tweet"},[e("div",{staticClass:"modal-background",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal.apply(null,arguments)}}}),e("div",{staticClass:"modal-container"},[e("div",{staticClass:"modal-header"},[e("div",{staticClass:"btn modal-close",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.closeModal.apply(null,arguments)}}},[e("img",{attrs:{src:s("6a23"),alt:""}})])]),e("form",{staticClass:"modal-content"},[e("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(t.user.avatar),alt:""}})]),e("div",{staticClass:"twitter-reply-container"},[e("router-link",{staticClass:"twitter-reply name",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[t._v(t._s(t.user.name)+" ")]),e("router-link",{staticClass:"twitter-reply info",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[t._v("@"+t._s(t.user.account))]),t._v("・ "),e("span",{staticClass:"text-muted"},[t._v(t._s(t._f("fromNow")(t.tweet.createdAt)))]),e("p",{staticClass:"twitter-reply content"},[t._v(" "+t._s(t.tweet.description)+" ")]),e("span",{staticClass:"twitter-reply-text"},[t._v("回覆給 ")]),e("router-link",{staticClass:"twitter-reply-account",attrs:{to:{name:"user",params:{id:t.user.UserId}}}},[t._v(" @"+t._s(t.user.account))])],1),e("router-link",{staticClass:"avatar avatar-reply",attrs:{to:{name:"user",params:{id:t.currentUser.id}}}},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(t.currentUser.avatar),alt:""}})]),e("div",{staticClass:"modal-line"}),e("div",{staticClass:"twitter-reply-container"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.twitterText,expression:"twitterText"}],staticClass:"twitter-text",attrs:{placeholder:"推你的回覆",maxlength:"200",required:""},domProps:{value:t.twitterText},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.resetwarningStatus.apply(null,arguments)},input:function(e){e.target.composing||(t.twitterText=e.target.value)}}})]),"length"===t.warningStatus?e("span",{staticClass:"warning-sign"},[t._v("字數不可超過 140 字")]):t._e(),"trim"===t.warningStatus?e("span",{staticClass:"warning-sign"},[t._v("內容不可空白")]):t._e(),e("button",{staticClass:"btn btn-post-reply-tweet",attrs:{disabled:t.isProcessing},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.createdTweet(t.tweet.id)}}},[t._v(" 回覆 ")])],1)])])])}),u=[],d=s("2fa3"),p=s("ac0d"),w=s("2f62"),m=s("6783"),g={props:{tweet:{type:Object,required:!0},user:{type:Object,required:!0}},mixins:[p["b"],p["c"]],computed:{...Object(w["c"])(["currentUser"])},data(){return{twitterText:"",modalStatus:!1,warningStatus:"",isProcessing:!1}},methods:{...Object(w["b"])(["updatePage"]),openModal(){this.modalStatus=!0},closeModal(){this.modalStatus=!1,this.twitterText="",this.warningStatus=""},async createdTweet(t){try{if(!this.twitterText.trim())return void(this.warningStatus="trim");if(this.twitterText.length>140)return void(this.warningStatus="length");this.isProcessing=!0;const{data:e}=await m["a"].replyTweet({tweetId:t,comment:this.twitterText.trim()});if("success"!==e.status)throw new Error(e.message);d["a"].fire({icon:"success",title:"回覆推文成功"}),this.isProcessing=!1,this.closeModal(),this.updatePage(!0)}catch(e){d["a"].fire({icon:"error",title:"無法回覆推文成功，請稍後再試"}),this.isProcessing=!1}},resetwarningStatus(){this.warningStatus=""}}},v=g,f=(s("540b"),s("2877")),h=Object(f["a"])(v,l,u,!1,null,"4ca6c2fa",null),C=h.exports,_={props:{tweet:{type:Object,required:!0},user:{type:Object,required:!0}},data(){return{isProcessing:!1}},mixins:[p["b"],p["c"],p["a"]],components:{ModalTweetReply1:C},methods:{async addLike(t){try{this.isProcessing=!0;const{data:e}=await m["a"].addLike({tweetId:t});if("success"!==e.status)throw new Error(e.message);this.tweet.isBeingLiked=!0,this.tweet.likesCounts+=1,this.isProcessing=!1}catch(e){this.isProcessing=!1,d["a"].fire({icon:"error",title:"無法按喜歡，請稍後再試"})}},async deleteLike(t){try{this.isProcessing=!0;const{data:e}=await m["a"].deleteLike({tweetId:t});if("success"!==e.status)throw new Error(e.message);this.tweet.isBeingLiked=!1,this.tweet.likesCounts-=1,this.isProcessing=!1}catch(e){this.isProcessing=!1,d["a"].fire({icon:"error",title:"無法按喜歡，請稍後再試"})}}}},y=_,b=(s("8e09"),Object(f["a"])(y,c,o,!1,null,"29067c57",null)),k=b.exports,P=s("aafe"),I=s("b222"),T={components:{NavBar:r["a"],TweetPopularUser:n["a"],TweetDetail:k,TweetReplies:P["a"],Spinner:I["a"]},data(){return{tweet:{id:-1,UserId:-1,description:"",likesCounts:-1,repliedCounts:-1,isBeingLiked:!0,createdAt:""},user:{UserId:-1,account:"",name:"",avatar:""},replies:[],isLoading:!0}},created(){const{id:t}=this.$route.params;this.fetchTweet(t),this.fetchReply(t)},beforeRouteUpdate(t,e,s){const{id:a}=t.params;this.fetchTweet(a),this.fetchReply(a),s()},computed:{...Object(w["c"])({updatePageNow:"updatePageNow"})},methods:{...Object(w["b"])(["updatePage"]),async fetchTweet(t){try{const{data:e}=await m["a"].getTweet({tweetId:t}),{id:s,UserId:a,description:i,likesCounts:r,repliedCounts:n,isBeingLiked:c,createdAt:o}=e,{account:l,name:u,avatar:d}=e.User;this.tweet={id:s,UserId:a,description:i,likesCounts:r,repliedCounts:n,isBeingLiked:c,createdAt:o},this.user={account:l,name:u,avatar:d,UserId:a},this.isLoading=!1}catch(e){this.isLoading=!1,d["a"].fire({icon:"error",title:"無法取得推文資料，請稍後再試"})}},async fetchReply(t){try{const{data:e}=await m["a"].getReply({tweetId:t});this.replies=[...e],this.isLoading=!1}catch(e){this.isLoading=!1,d["a"].fire({icon:"error",title:"無法取得回覆推文資料，請稍後再試"})}}},watch:{updatePageNow(){if(this.updatePageNow){const{id:t}=this.$route.params;this.fetchTweet(t),this.fetchReply(t),this.updatePage(!1)}}}},x=T,U=(s("fac3"),Object(f["a"])(x,a,i,!1,null,"a85e6f16",null));e["default"]=U.exports},"8e09":function(t,e,s){"use strict";s("f2d7")},aafe:function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("section",{staticClass:"tweet-popular-section"},[e("div",{staticClass:"tweet-popular-container"},t._l(t.initialreplies,(function(s){return e("div",{key:s.id,staticClass:"tweet"},[e("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:s.UserId}}}},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(s.User.avatar),alt:""}})]),e("div",{staticClass:"tweet-info"},[e("div",{staticClass:"tweet-user"},[e("router-link",{staticClass:"tweet-user name",attrs:{to:{name:"user",params:{id:s.UserId}}}},[t._v(t._s(s.User.name))]),e("router-link",{staticClass:"tweet-user account",attrs:{to:{name:"user",params:{id:s.UserId}}}},[t._v("@"+t._s(s.User.account)+" ・ "+t._s(t._f("fromNow")(s.createdAt)))])],1),e("div",{staticClass:"tweet-reply"},[e("span",{staticClass:"text-reply"},[t._v("回覆 ")]),e("router-link",{staticClass:"account",attrs:{to:{name:"user",params:{id:s.Tweet.User.id}}}},[t._v("@"+t._s(s.Tweet.User.account))])],1),e("p",{staticClass:"tweet-content"},[t._v(t._s(s.comment))])])],1)})),0)])},i=[],r=s("ac0d"),n=s("2f62"),c={mixins:[r["c"],r["b"]],props:{initialreplies:{type:Array,require:!0}},data(){return{tweets:{}}},computed:{...Object(n["c"])({updatePageNow:"updatePageNow"})},methods:{...Object(n["b"])(["updatePage"])},watch:{updatePageNow(){this.updatePageNow&&this.updatePage(!1)}}},o=c,l=(s("ad7e"),s("2877")),u=Object(l["a"])(o,a,i,!1,null,"2e9861e0",null);e["a"]=u.exports},ad7e:function(t,e,s){"use strict";s("4565")},f2d7:function(t,e,s){},fac3:function(t,e,s){"use strict";s("2409")}}]);
//# sourceMappingURL=chunk-9fef6a0a.35e93f00.js.map