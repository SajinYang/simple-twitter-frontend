(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7de0c585"],{"0f64":function(t,e,a){},"12bf":function(t,e,a){t.exports=a.p+"img/add-notify.843fff15.svg"},"4a39":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-twitter"},[e("NavBar"),e("section",{staticClass:"center-section"},[e("header",{staticClass:"title"},[e("img",{staticClass:"icon-back",attrs:{src:a("4ba8"),alt:""},on:{click:function(e){return t.$router.back()}}}),e("div",{staticClass:"user-title"},[e("h5",{},[t._v(t._s(t.profile.name))]),e("p",{staticClass:"text-muted"},[t._v(t._s(t.profile.tweetsCounts)+" 推文")])])]),t.isLoading?e("Spinner"):e("main",{staticClass:"center-container scrollbar"},[e("div",{staticClass:"profile-img"},[e("div",{staticClass:"avatar-thumbnail"},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(t.profile.avatar),alt:"avatar-image"}})]),e("img",{staticClass:"d-block banner-img-thumbnail",attrs:{src:t._f("emptyCover")(t.profile.cover),alt:"banner-image"}})]),e("div",{staticClass:"profile-detail px-4"},[e("div",{staticClass:"button-group my-3"},[t.currentUser.id===t.profile.id?e("button",{staticClass:"btn-edit",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.isEditing=!0}}},[t._v(" 編輯個人資料 ")]):e("div",{staticClass:"btn-follow"},[e("button",{staticClass:"btn-direct-message p-2"},[e("img",{attrs:{src:a("9557"),alt:"direct-message"}})]),e("button",{staticClass:"btn-notification"},[e("img",{attrs:{src:a("12bf"),alt:"get-notify"}})]),t.profile.isFollowing?e("button",{staticClass:"btn toggle-follow following",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteFollowing(t.profile.id)}}},[t._v(" 正在跟隨 ")]):e("button",{staticClass:"btn toggle-follow",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addFollowing(t.profile.id)}}},[t._v(" 跟隨 ")])])]),e("h5",[t._v(t._s(t.profile.name))]),e("span",{staticClass:"text-muted mb-1"},[t._v("@"+t._s(t.profile.account))]),e("p",[t._v(t._s(t.profile.introduction))]),e("div",{staticClass:"follow-status"},[e("span",{staticClass:"following-text"},[t._v(t._s(t.profile.followingsCounts)+"個 "),e("router-link",{attrs:{to:{name:"user-following",params:{id:t.profile.id}}}},[e("span",{staticClass:"text-light"},[t._v("跟隨中")])])],1),e("span",{staticClass:"follower"},[t._v(t._s(t.profile.followersCounts)+"位 "),e("router-link",{attrs:{to:{name:"user-follower",params:{id:t.profile.id}}}},[e("span",{staticClass:"text-light"},[t._v("跟隨者")])])],1)])]),e("router-view")],1),e("ModalEditProfile",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"isEditing"}],attrs:{"initial-profile":t.profile},on:{close:t.handleModalClose}})],1),e("TweetPopularUser")],1)},i=[],r=(a("d9e2"),a("d000")),n=a("6e47"),o=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"modal-mask"},[e("div",{staticClass:"modal-wrapper"},[e("div",{staticClass:"modal-container"},[e("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-header-title",attrs:{name:"modal-header"}},[t._v("編輯個人資料")]),e("button",{staticClass:"modal-close-button",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleCancel.apply(null,arguments)}}},[e("img",{staticClass:"btn-close",attrs:{src:a("6a23"),alt:""}})]),e("button",{staticClass:"btn-save",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" "+t._s(t.isProcessing?"儲存中":"儲存")+" ")])]),e("div",{staticClass:"modal-body scrollbar"},[e("div",{staticClass:"container-image"},[e("div",{staticClass:"avatar-container"},[e("div",{staticClass:"avatar-image-container"},[e("label",{staticClass:"avatar-image-label",attrs:{for:"avatar-image"}}),e("div",{staticClass:"avatar-thumbnail"},[e("img",{staticClass:"avatarImg",attrs:{src:t._f("emptyImage")(t.user.avatar),alt:"avatar-image"}})]),t.user.avatar?t._e():e("div",{staticClass:"bg-mask avatar-mask"})]),e("input",{staticClass:"form-control-file",attrs:{id:"avatar-image",type:"file",name:"avatar",accept:"image/*"},on:{change:t.handleAvatarFileChange}})]),e("div",{staticClass:"banner"},[e("div",{staticClass:"banner-container"},[e("div",{staticClass:"banner-image-container"},[e("div",{staticClass:"banner-btn-control"},[e("label",{staticClass:"banner-image-label pe-5",attrs:{for:"image"}}),e("button",{staticClass:"modal-close-button",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleBannerFileCancel.apply(null,arguments)}}},[e("img",{staticClass:"btn-close banner-cancel",attrs:{src:a("6a23"),alt:"close-button"}})])]),e("img",{staticClass:"d-block banner-img-thumbnail",attrs:{src:t._f("emptyCover")(t.user.cover),alt:"banner-image"}}),t.user.cover?t._e():e("div",{staticClass:"bg-mask banner-mask"})]),e("input",{staticClass:"form-control-file",attrs:{id:"image",type:"file",name:"cover",accept:"image/*"},on:{change:t.handleBannerFileChange}})])])]),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],attrs:{type:"text",name:"name",id:"name",maxlength:"100",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}}),e("label",{attrs:{for:"name"}},[t._v("名稱")]),e("div",{staticClass:"input-hints"},[e("span",{staticClass:"error",style:{visibility:t.user.name.length>50?"visible":"hidden"}},[t._v(" 字數超出上限！ ")]),t.user.name.length?e("span",{class:{error:t.user.name.length>50}},[t._v(" "+t._s(t.user.name.length)+"/50")]):t._e()])]),e("div",{staticClass:"input-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.user.introduction,expression:"user.introduction"}],staticClass:"self-intro",attrs:{name:"introduction",id:"introduction",cols:"30",rows:"10",placeholder:"讓社群更認識你"},domProps:{value:t.user.introduction},on:{input:function(e){e.target.composing||t.$set(t.user,"introduction",e.target.value)}}}),e("label",{attrs:{for:"introduction"}},[t._v("自我介紹")]),e("div",{staticClass:"input-hints"},[e("span",{staticClass:"error",style:{visibility:t.user.introduction.length>160?"visible":"hidden"}},[t._v(" 字數超出上限！ ")]),t.user.introduction.length?e("span",{class:{error:t.user.introduction.length>160}},[t._v(" "+t._s(t.user.introduction.length)+"/160 ")]):t._e()])])])])])])])])])},l=[],c=a("4cce"),u=a("2fa3"),d=a("ac0d"),f={mixins:[d["b"]],props:{initialProfile:{type:Object,required:!0}},data(){return{user:{id:-1,name:"",nameCached:"",introduction:"",introCached:"",avatar:null,avatarCached:"",cover:null,coverCached:""},isProcessing:!1}},methods:{fetchUserProfile(t){const{id:e,name:a,introduction:s,avatar:i,cover:r}=t;this.user={...this.user,id:e,name:a,nameCached:a,introduction:s,introCached:s,avatar:i,avatarCached:i,cover:r,coverCached:r}},handleAvatarFileChange(t){const{files:e}=t.target;if(0===e.length)this.user.avatar="";else if(e[0].size>8388608)u["a"].fire({icon:"error",title:"超過檔案大小上限8MB，請重新上傳"}),this.user.avatar="";else{const t=window.URL.createObjectURL(e[0]);this.user.avatar=t}},handleBannerFileChange(t){const{files:e}=t.target;if(0===e.length)this.user.cover="";else if(e[0].size>8388608)u["a"].fire({icon:"error",title:"超過檔案大小上限8MB，請重新上傳"}),this.user.cover="";else{const t=window.URL.createObjectURL(e[0]);this.user.cover=t}},handleBannerFileCancel(){this.user={...this.user,cover:this.user.coverCached}},async handleSubmit(t){try{if(!this.user.name)return void u["a"].fire({icon:"error",title:"使用者名稱為必填，請確認已填寫"});if(this.user.name.trim().length>50||this.user.introduction.trim().length>160)return void u["a"].fire({icon:"error",title:"超過字數上限，請重新修改"});if(this.user.name===this.user.nameCached&&this.user.introduction===this.user.introCached&&this.user.avatar===this.user.avatarCached&&this.user.cover===this.user.coverCached)return u["a"].fire({icon:"success",title:"成功更新使用者資料"}),this.isProcessing=!1,void this.$emit("close");this.isProcessing=!0;const e=t.target,a=new FormData(e),{data:s}=await c["a"].updateProfile({userId:this.user.id,data:a});if("success"!==s.status)throw new Error(s.message);u["a"].fire({icon:"success",title:"成功更新使用者資料"}),this.isProcessing=!1,this.$router.go(0)}catch(e){this.isProcessing=!1,u["a"].fire({icon:"error",title:"無法編輯使用者資料，請稍後再試"})}},handleCancel(){this.user={...this.user,name:this.user.nameCached,introduction:this.user.introCached,avatar:this.user.avatarCached,cover:this.user.coverCached},this.$emit("close")}},created(){this.fetchUserProfile(this.initialProfile)},watch:{initialProfile(t){this.fetchUserProfile(t)}}},h=f,m=(a("ab3c"),a("2877")),p=Object(m["a"])(h,o,l,!1,null,"bf89ee08",null),v=p.exports,g=a("b025"),C=a("2f62"),b=a("b222"),w={name:"UserProfile",mixins:[d["b"]],data(){return{profile:{id:-1,account:"",name:"",email:"",introduction:"",avatar:null,cover:null,tweetsCounts:0,followingsCounts:0,followersCounts:0,isFollowing:!1},isEditing:!1,isLoading:!0}},components:{NavBar:r["a"],TweetPopularUser:n["a"],ModalEditProfile:v,Spinner:b["a"]},methods:{...Object(C["b"])(["updatePage"]),async fetchUserProfile(t){try{const{data:e}=await c["a"].getProfile({userId:t});if("success"!==e.status)throw new Error(e.message);this.profile=e,delete this.profile.status,delete this.profile.message,this.profile={...this.profile,introduction:this.profile.introduction?this.profile.introduction:""},this.isLoading=!1}catch(e){this.isLoading=!1,u["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"})}},async addFollowing(t){try{const{data:e}=await g["a"].addFollow({id:t});if("success"!==e.status)throw new Error(e.message);this.profile.isFollowing=!0,this.profile.followersCounts+=1,u["a"].fire({icon:"success",title:"追蹤成功"}),this.updatePage(!0)}catch(e){u["a"].fire({icon:"error",title:"追蹤失敗，請稍後再試"})}},async deleteFollowing(t){try{const{data:e}=await g["a"].deleteFollow({id:t});if("success"!==e.status)throw new Error(e.message);this.profile.isFollowing=!1,this.profile.followersCounts-=1,u["a"].fire({icon:"success",title:"已取消追蹤"}),this.updatePage(!0)}catch(e){u["a"].fire({icon:"error",title:"無法取消追蹤，請稍後再試"})}},handleModalClose(){this.isEditing=!1}},created(){const{id:t}=this.$route.params;this.fetchUserProfile(t)},beforeRouteUpdate(t,e,a){const{id:s}=t.params;this.fetchUserProfile(s),a()},computed:{...Object(C["c"])(["currentUser"]),...Object(C["c"])({updatePageNow:"updatePageNow"})},watch:{updatePageNow(){if(this.updatePageNow){const{id:t}=this.$route.params;this.fetchUserProfile(t)}}}},_=w,P=(a("acb8"),Object(m["a"])(_,s,i,!1,null,"06eda298",null));e["default"]=P.exports},"4ba8":function(t,e,a){t.exports=a.p+"img/tweet-back.6008f2d3.svg"},9557:function(t,e,a){t.exports=a.p+"img/direct-message.289a5ba1.svg"},ab3c:function(t,e,a){"use strict";a("b1a0")},acb8:function(t,e,a){"use strict";a("0f64")},b1a0:function(t,e,a){}}]);
//# sourceMappingURL=chunk-7de0c585.6a501588.js.map